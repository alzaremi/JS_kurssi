<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel= "stylesheet" href="/EN TIIÄ VIEL/workshop5/styles.css">
  <title>Workshop5</title>
</head>
<body>
  <form id="contactForm" onsubmit="validateForm(event)">
    <label for="name">Nimi</label>
    <br>
    <input type="text" id="name" name="name" required>
    <span id="nameError" class="error-message"></span>
    <br>
    <label for="email">Sähköposti</label>
    <br>
    <input type="email" id="email" name="email" required minlength="6" maxlength="15">
    <span id="emailError" class="error-message"></span>
    <br>
    <label for="msg">Viesti:</label>
    <br>
    <input type="text" id="msg" name="msg" required maxlength="150">
    <span id="msgError" class="error-message"></span>
    <br> <br>
    <button type="submit">Lähetä ja tallenna LocalStorageen</button>
  </form>
  <br> <br> <br>
  <button onclick="naytaData()">Lataa tallennetut tiedot</button>
  <h3>Tallennetut tiedot:</h3>
  <div id="sessiondata"></div>

  <script>
    const contactForm=document.getElementById("contactForm");
    contactForm.addEventListener("submit", function(event){
      event.preventDefault();
      const email = document.getElementById("email");
      const name = document.getElementById("name");
      const msg = document.getElementById("msg");
      const nameError = document.getElementById("nameError");
      const emailError = document.getElementById("emailError");
      const msgError = document.getElementById("msgError"); 
      [name, email, msg].forEach(el => el.classList.remove("error", "success"));
      [nameError, emailError, msgError].forEach (span => span.textContent = "");
      let isValid = true;
      if (name.value.trim() ==="") {
        name.classList.add("error");
        nameError.textContent = "Nimi on pakollinen.";
        isValid = false;
      } else {
        name.classList.add("success");
      }
      if (email.value.trim()==="") {
        email.classList.add("error");
        emailError.textContent="Sähköposti on pakollinen.";
        isValid = false;
      } else if(!email.value.includes("@")) {
        email.classList.add("error");
        emailError.textContent= "Sähköpostissa tulee olla @-merkki.";
        isValid = false;
      } else {
        email.classList.add("success");
      }
      if (msg.value.trim() === "") {
        msg.classList.add("error");
        msgError.textContent = "Viestikenttä ei voi olla tyhjä.";
        isValid = false;
      } else {
        msg.classList.add("success");
      }
      if (isValid) {
        localStorage.setItem("nimi", name.value);
        localStorage.setItem("sähköposti", email.value);
        localStorage.setItem("viesti", msg.value);
        alert("Tiedot on tallennettu LocalStorageen!");
        naytaData();
      }
    });

    function naytaData() {
      const sessionDiv = document.getElementById("sessiondata");
      const nimi = localStorage.getItem("nimi");
      const email = localStorage.getItem("sähköposti");
      const viesti = localStorage.getItem("viesti");
      if (nimi || email || viesti) {
        sessionDiv.innerHTML = `
          <p><strong>Nimi:</strong> ${nimi ?? "-"}<br>
          <strong>Sähköposti:</strong> ${email ?? "-"}<br>
          <strong>Viesti:</strong> ${viesti ?? "-"}</p>
        `;
      } else {
        sessionDiv.innerHTML = "<p>Ei tallennettuja tietoja.</p>";
      }
    }

    window.onload = function() {
      naytaData();
    };
  </script>
</body>
</html>
